# Set up lattice
vector_a = [11.5200422577, 0.0, 0.0]*Angstrom
vector_b = [-5.76002112887, 9.97664924787, 0.0]*Angstrom
vector_c = [0.0, 0.0, 14.3114751156]*Angstrom
lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
elements = [Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen]

# Define coordinates
fractional_coordinates = [[ 0.        ,  0.        ,  0.        ],
                          [ 0.33333333,  0.        ,  0.        ],
                          [ 0.66666667,  0.        ,  0.        ],
                          [ 0.        ,  0.33333333,  0.        ],
                          [ 0.33333333,  0.33333333,  0.        ],
                          [ 0.66666667,  0.33333333,  0.        ],
                          [ 0.        ,  0.66666667,  0.        ],
                          [ 0.33333333,  0.66666667,  0.        ],
                          [ 0.66666667,  0.66666667,  0.        ],
                          [ 0.11111111,  0.22222222,  0.05477001],
                          [ 0.44444444,  0.22222222,  0.05477001],
                          [ 0.77777778,  0.22222222,  0.05477001],
                          [ 0.11111111,  0.55555556,  0.05477001],
                          [ 0.44444444,  0.55555556,  0.05477001],
                          [ 0.77777778,  0.55555556,  0.05477001],
                          [ 0.11111111,  0.88888889,  0.05477001],
                          [ 0.44444444,  0.88888889,  0.05477001],
                          [ 0.77777778,  0.88888889,  0.05477001],
                          [ 0.16534281,  0.27213134,  0.21283798],
                          [ 0.46685418,  0.23355219,  0.22131146],
                          [ 0.83272605,  0.27208255,  0.21032623],
                          [ 0.14719951,  0.60767026,  0.21834373],
                          [ 0.48435367,  0.59538243,  0.21592262],
                          [ 0.80481295,  0.57593439,  0.22085121],
                          [ 0.12267693,  0.91633062,  0.22224981],
                          [ 0.47860449,  0.93186024,  0.21401271],
                          [ 0.81363413,  0.916107  ,  0.2144149 ],
                          [ 0.24480375,  0.13742221,  0.27485994],
                          [ 0.6091748 ,  0.14859418,  0.26695497],
                          [ 0.9380398 ,  0.15015292,  0.24741671],
                          [ 0.26064886,  0.49552147,  0.25999421],
                          [ 0.57727338,  0.46054712,  0.26032409],
                          [ 0.9321435 ,  0.48621846,  0.28417081],
                          [ 0.2574791 ,  0.82932194,  0.27239367],
                          [ 0.59274779,  0.82089157,  0.2618161 ],
                          [ 0.90679144,  0.79594913,  0.28363174],
                          [ 0.21835476,  0.14086893,  0.43625589],
                          [ 0.68772805,  0.14229005,  0.41917221],
                          [ 0.90711915,  0.16870714,  0.40458478],
                          [ 0.25902268,  0.48061172,  0.41907373],
                          [ 0.5771553 ,  0.42316747,  0.42012701],
                          [ 0.94165529,  0.50272218,  0.45162663],
                          [ 0.25809478,  0.83517946,  0.4369582 ],
                          [ 0.57261732,  0.78671188,  0.42007069],
                          [ 0.90175738,  0.80729929,  0.44980301],
                          [-0.01477881,  0.04122069,  0.48348004],
                          [ 0.35285886,  0.0569991 ,  0.50627109],
                          [ 0.65182382, -0.03235383,  0.52386097],
                          [ 0.05117332,  0.36685645,  0.48768058],
                          [ 0.36166038,  0.36296221,  0.47505288],
                          [ 0.71610211,  0.343683  ,  0.48125471],
                          [ 0.04298946,  0.7354088 ,  0.52069963],
                          [ 0.35004425,  0.69982054,  0.47220472],
                          [ 0.66679171,  0.65094233,  0.44533686],
                          [ 0.86547033,  0.08340501,  0.59826559],
                          [ 0.55209611,  0.21677395,  0.59097685],
                          [ 0.23078994,  0.3452882 ,  0.60191619],
                          [ 1.11173322,  0.53657598,  0.60003319],
                          [ 0.68519899,  0.6551063 ,  0.60143245],
                          [ 0.45390185,  0.81583124,  0.60183973],
                          [ 0.1706391 ,  0.95153862,  0.60465789],
                          [ 0.14696517,  0.07690145,  0.64526031],
                          [ 0.87216578,  0.22359584,  0.64143964],
                          [ 0.53213575,  0.3138131 ,  0.66967035],
                          [ 0.27527067,  0.50386518,  0.64667505],
                          [ 0.00142528,  0.66781093,  0.64119222],
                          [ 0.72463846,  0.79288896,  0.65502413],
                          [ 0.39096133,  0.888603  ,  0.67031718],
                          [ 0.59156152,  0.1348468 ,  0.67122349],
                          [ 0.29381662,  0.31454084,  0.70194015],
                          [ 0.02226244,  0.4639889 ,  0.7005007 ],
                          [ 0.71745283,  0.56543619,  0.67319044],
                          [ 0.47644777,  0.72990752,  0.68748663],
                          [ 0.17482068,  0.89740401,  0.71458726],
                          [ 0.88683752,  1.03442031,  0.70330445],
                          [ 0.50417562,  0.00493392,  0.73584573],
                          [ 0.22623407,  0.16185689,  0.73753102],
                          [ 0.94425673,  0.30951285,  0.7365769 ],
                          [ 0.64494299,  0.42781952,  0.73520206],
                          [ 0.37089948,  0.58993151,  0.73561077],
                          [ 0.08805395,  0.73947143,  0.73667766],
                          [ 0.80551885,  0.88640656,  0.74271257],
                          [ 0.32761429,  0.12944286,  0.79318563],
                          [ 0.0419    ,  0.2723    ,  0.79318563],
                          [ 0.75618571,  0.41515714,  0.79318563],
                          [ 0.47047143,  0.55801429,  0.79318563],
                          [ 0.18475714,  0.70087143,  0.79318563],
                          [ 0.89904286,  0.84372857,  0.79318563],
                          [ 0.61332857,  0.98658571,  0.79318563],
                          [ 0.13532857,  0.13908571,  0.82911745],
                          [ 0.84961429,  0.28194286,  0.82911745],
                          [ 0.5639    ,  0.4248    ,  0.82911745],
                          [ 0.27818571,  0.56765714,  0.82911745],
                          [ 0.99247143,  0.71051429,  0.82911745],
                          [ 0.70675714,  0.85337143,  0.82911745],
                          [ 0.42104286,  0.99622857,  0.82911745],
                          [ 0.35281429,  0.05844286,  0.87410103],
                          [ 0.0671    ,  0.2013    ,  0.87410103],
                          [ 0.78138571,  0.34415714,  0.87410103],
                          [ 0.49567143,  0.48701429,  0.87410103],
                          [ 0.20995714,  0.62987143,  0.87410103],
                          [ 0.92424286,  0.77272857,  0.87410103],
                          [ 0.63852857,  0.91558571,  0.87410103],
                          [ 0.94468571,  0.10095714,  0.91908486],
                          [ 0.65897143,  0.24381429,  0.91908486],
                          [ 0.37325714,  0.38667143,  0.91908486],
                          [ 0.08754286,  0.52952857,  0.91908486],
                          [ 0.80182857,  0.67238571,  0.91908486],
                          [ 0.51611429,  0.81524286,  0.91908486],
                          [ 0.2304    ,  0.9581    ,  0.91908486],
                          [ 0.71804286,  0.00752857,  0.9550163 ],
                          [ 0.43232857,  0.15038571,  0.9550163 ],
                          [ 0.14661429,  0.29324286,  0.9550163 ],
                          [ 0.8609    ,  0.4361    ,  0.9550163 ],
                          [ 0.57518571,  0.57895714,  0.9550163 ],
                          [ 0.28947143,  0.72181429,  0.9550163 ],
                          [ 0.00375714,  0.86467143,  0.9550163 ]]

# Set up configuration
bulk_configuration = BulkConfiguration(
    bravais_lattice=lattice,
    elements=elements,
    fractional_coordinates=fractional_coordinates
    )
# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------
#----------------------------------------
# Basis Set
#----------------------------------------
basis_set = [
    GGABasis.Oxygen_DoubleZetaPolarized,
    GGABasis.Silicon_DoubleZetaPolarized,
    ]

#----------------------------------------
# Exchange-Correlation
#----------------------------------------
exchange_correlation = GGA.PBE

numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=(2, 2, 2),
    density_mesh_cutoff=65.0*Rydberg,
    )

calculator = LCAOCalculator(
    basis_set=basis_set,
    exchange_correlation=exchange_correlation,
    numerical_accuracy_parameters=numerical_accuracy_parameters,
    )

bulk_configuration.setCalculator(calculator)
nlprint(bulk_configuration)
bulk_configuration.update()
nlsave('scripter_si_sio2_relaxed_analysis.py.nc', bulk_configuration)

# -------------------------------------------------------------
# Electron density
# -------------------------------------------------------------
electron_density = ElectronDensity(
    configuration=bulk_configuration,
    )
nlsave('scripter_si_sio2_relaxed_analysis.py.nc', electron_density)

# -------------------------------------------------------------
# Density of states
# -------------------------------------------------------------
density_of_states = DensityOfStates(
    configuration=bulk_configuration,
    kpoints=MonkhorstPackGrid(9,9,9),
    energy_zero_parameter=FermiLevel,
    bands_above_fermi_level=None,
    )
nlsave('scripter_si_sio2_relaxed_analysis.py.nc', density_of_states)
nlprint(density_of_states)
