# -------------------------------------------------------------
# Bulk configuration
# -------------------------------------------------------------

# Set up lattice
vector_a = [11.5200422577, 0.0, 0.0]*Angstrom
vector_b = [-5.76002112887, 9.97664924787, 0.0]*Angstrom
vector_c = [0.0, 0.0, 14.3114751156]*Angstrom
lattice = UnitCell(vector_a, vector_b, vector_c)

# Define elements
elements = [Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Silicon, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Silicon, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Silicon, Silicon, Silicon, Silicon,
            Silicon, Silicon, Silicon, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen, Oxygen,
            Oxygen]

# Define coordinates
fractional_coordinates = [[ 0.        ,  0.        ,  0.        ],
                          [ 0.33333333,  0.        ,  0.        ],
                          [ 0.66666667,  0.        ,  0.        ],
                          [ 0.        ,  0.33333333,  0.        ],
                          [ 0.33333333,  0.33333333,  0.        ],
                          [ 0.66666667,  0.33333333,  0.        ],
                          [ 0.        ,  0.66666667,  0.        ],
                          [ 0.33333333,  0.66666667,  0.        ],
                          [ 0.66666667,  0.66666667,  0.        ],
                          [ 0.11111111,  0.22222222,  0.05477001],
                          [ 0.44444444,  0.22222222,  0.05477001],
                          [ 0.77777778,  0.22222222,  0.05477001],
                          [ 0.11111111,  0.55555556,  0.05477001],
                          [ 0.44444444,  0.55555556,  0.05477001],
                          [ 0.77777778,  0.55555556,  0.05477001],
                          [ 0.11111111,  0.88888889,  0.05477001],
                          [ 0.44444444,  0.88888889,  0.05477001],
                          [ 0.77777778,  0.88888889,  0.05477001],
                          [ 0.11111111,  0.22222222,  0.21908003],
                          [ 0.44444444,  0.22222222,  0.21908003],
                          [ 0.77777778,  0.22222222,  0.21908003],
                          [ 0.11111111,  0.55555556,  0.21908003],
                          [ 0.44444444,  0.55555556,  0.21908003],
                          [ 0.77777778,  0.55555556,  0.21908003],
                          [ 0.11111111,  0.88888889,  0.21908003],
                          [ 0.44444444,  0.88888889,  0.21908003],
                          [ 0.77777778,  0.88888889,  0.21908003],
                          [ 0.22222222,  0.11111111,  0.27385004],
                          [ 0.55555556,  0.11111111,  0.27385004],
                          [ 0.88888889,  0.11111111,  0.27385004],
                          [ 0.22222222,  0.44444444,  0.27385004],
                          [ 0.55555556,  0.44444444,  0.27385004],
                          [ 0.88888889,  0.44444444,  0.27385004],
                          [ 0.22222222,  0.77777778,  0.27385004],
                          [ 0.55555556,  0.77777778,  0.27385004],
                          [ 0.88888889,  0.77777778,  0.27385004],
                          [ 0.22222222,  0.11111111,  0.43816006],
                          [ 0.55480764,  0.1109317 ,  0.43936055],
                          [ 0.90371305,  0.12096121,  0.4173212 ],
                          [ 0.22189609,  0.44490345,  0.43758266],
                          [ 0.55555556,  0.44444444,  0.43816006],
                          [ 0.88274373,  0.44237844,  0.43352111],
                          [ 0.22222222,  0.77777778,  0.43816006],
                          [ 0.55573416,  0.77759837,  0.43812088],
                          [ 0.88888889,  0.77777778,  0.43816006],
                          [ 0.        ,  0.        ,  0.49293006],
                          [ 0.33333333,  0.        ,  0.49293006],
                          [ 0.66039989, -0.0043002 ,  0.49179683],
                          [ 0.0010097 ,  0.33165497,  0.492327  ],
                          [ 0.35733097,  0.33157979,  0.45813411],
                          [ 0.69305676,  0.36033227,  0.47487726],
                          [-0.01381943,  0.67020303,  0.51320191],
                          [ 0.31541496,  0.6470799 ,  0.47358721],
                          [ 0.64889526,  0.68279344,  0.43870799],
                          [ 0.8370075 ,  0.08062492,  0.54122123],
                          [ 0.54718868,  0.21616451,  0.53933969],
                          [ 0.24541218,  0.35845293,  0.54316299],
                          [ 0.99930213,  0.48859205,  0.537366  ],
                          [ 0.71073715,  0.64106187,  0.54870168],
                          [ 0.43664596,  0.80547961,  0.53798942],
                          [ 0.13920877,  0.94438199,  0.53965984],
                          [ 0.13425526,  0.03014286,  0.65167822],
                          [ 0.84685217,  0.17292084,  0.65288504],
                          [ 0.56321318,  0.31507232,  0.65129754],
                          [ 0.2753921 ,  0.46056424,  0.65280733],
                          [ 0.00205879,  0.61296474,  0.6302702 ],
                          [ 0.70439313,  0.74137953,  0.65257701],
                          [ 0.42085526,  0.8857482 ,  0.65086551],
                          [ 0.566882  ,  0.16845811,  0.65944073],
                          [ 0.27761402,  0.31063677,  0.66021519],
                          [ 0.00004531,  0.45361185,  0.66099626],
                          [ 0.71621472,  0.59590849,  0.669178  ],
                          [ 0.42769647,  0.74075421,  0.65967993],
                          [ 0.14664691,  0.88940338,  0.66350701],
                          [ 0.85137362,  1.0221441 ,  0.65942684],
                          [ 0.50631014,  0.02510792,  0.71235017],
                          [ 0.22116115,  0.16862163,  0.71282935],
                          [ 0.93507263,  0.31076282,  0.71431204],
                          [ 0.64973817,  0.4499454 ,  0.71574212],
                          [ 0.36550041,  0.59889394,  0.71198713],
                          [ 0.08223314,  0.74050527,  0.71145315],
                          [ 0.79172354,  0.88108316,  0.71211607],
                          [ 0.32761429,  0.12944286,  0.79318563],
                          [ 0.0419    ,  0.2723    ,  0.79318563],
                          [ 0.75618571,  0.41515714,  0.79318563],
                          [ 0.47047143,  0.55801429,  0.79318563],
                          [ 0.18475714,  0.70087143,  0.79318563],
                          [ 0.89904286,  0.84372857,  0.79318563],
                          [ 0.61332857,  0.98658571,  0.79318563],
                          [ 0.13532857,  0.13908571,  0.82911745],
                          [ 0.84961429,  0.28194286,  0.82911745],
                          [ 0.5639    ,  0.4248    ,  0.82911745],
                          [ 0.27818571,  0.56765714,  0.82911745],
                          [ 0.99247143,  0.71051429,  0.82911745],
                          [ 0.70675714,  0.85337143,  0.82911745],
                          [ 0.42104286,  0.99622857,  0.82911745],
                          [ 0.35281429,  0.05844286,  0.87410103],
                          [ 0.0671    ,  0.2013    ,  0.87410103],
                          [ 0.78138571,  0.34415714,  0.87410103],
                          [ 0.49567143,  0.48701429,  0.87410103],
                          [ 0.20995714,  0.62987143,  0.87410103],
                          [ 0.92424286,  0.77272857,  0.87410103],
                          [ 0.63852857,  0.91558571,  0.87410103],
                          [ 0.94468571,  0.10095714,  0.91908486],
                          [ 0.65897143,  0.24381429,  0.91908486],
                          [ 0.37325714,  0.38667143,  0.91908486],
                          [ 0.08754286,  0.52952857,  0.91908486],
                          [ 0.80182857,  0.67238571,  0.91908486],
                          [ 0.51611429,  0.81524286,  0.91908486],
                          [ 0.2304    ,  0.9581    ,  0.91908486],
                          [ 0.71804286,  0.00752857,  0.9550163 ],
                          [ 0.43232857,  0.15038571,  0.9550163 ],
                          [ 0.14661429,  0.29324286,  0.9550163 ],
                          [ 0.8609    ,  0.4361    ,  0.9550163 ],
                          [ 0.57518571,  0.57895714,  0.9550163 ],
                          [ 0.28947143,  0.72181429,  0.9550163 ],
                          [ 0.00375714,  0.86467143,  0.9550163 ]]

# Set up configuration
bulk_configuration = BulkConfiguration(
    bravais_lattice=lattice,
    elements=elements,
    fractional_coordinates=fractional_coordinates
    )

# -------------------------------------------------------------
# Calculator
# -------------------------------------------------------------
#----------------------------------------
# Basis Set
#----------------------------------------
basis_set = [
    GGABasis.Oxygen_DoubleZetaPolarized,
    GGABasis.Silicon_DoubleZetaPolarized,
    ]

#----------------------------------------
# Exchange-Correlation
#----------------------------------------
exchange_correlation = GGA.PBE

numerical_accuracy_parameters = NumericalAccuracyParameters(
    k_point_sampling=(2, 2, 2),
    density_mesh_cutoff=65.0*Rydberg,
    )

calculator = LCAOCalculator(
    basis_set=basis_set,
    exchange_correlation=exchange_correlation,
    numerical_accuracy_parameters=numerical_accuracy_parameters,
    )

bulk_configuration.setCalculator(calculator)
nlprint(bulk_configuration)
bulk_configuration.update()
nlsave('scripter_si_sio2_init_analysis.py.nc', bulk_configuration)

# -------------------------------------------------------------
# Electron density
# -------------------------------------------------------------
electron_density = ElectronDensity(
    configuration=bulk_configuration,
    )
nlsave('scripter_si_sio2_init_analysis.py.nc', electron_density)

# -------------------------------------------------------------
# Density of states
# -------------------------------------------------------------
density_of_states = DensityOfStates(
    configuration=bulk_configuration,
    kpoints=MonkhorstPackGrid(2,2,2),
    energy_zero_parameter=FermiLevel,
    bands_above_fermi_level=None,
    )
nlsave('scripter_si_sio2_init_analysis.py.nc', density_of_states)
nlprint(density_of_states)
